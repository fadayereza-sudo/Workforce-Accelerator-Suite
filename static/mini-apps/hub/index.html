<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Workforce Hub</title>

    <!-- Telegram Web App SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <style>
        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           DESIGN SYSTEM - Premium aesthetics for Telegram Mini App
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

        :root {
            /* Telegram Theme Variables (overridden by SDK) */
            --tg-theme-bg-color: #ffffff;
            --tg-theme-secondary-bg-color: #f4f4f5;
            --tg-theme-text-color: #000000;
            --tg-theme-hint-color: #999999;
            --tg-theme-link-color: #2481cc;
            --tg-theme-button-color: #2481cc;
            --tg-theme-button-text-color: #ffffff;

            /* Extended Palette */
            --color-success: #10b981;
            --color-success-light: #d1fae5;
            --color-warning: #f59e0b;
            --color-warning-light: #fef3c7;
            --color-error: #ef4444;
            --color-error-light: #fee2e2;

            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-success: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            --gradient-warm: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);

            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            --shadow-glow: 0 0 20px rgba(102, 126, 234, 0.3);

            /* Typography */
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;

            /* Spacing */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;

            /* Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-full: 9999px;

            /* Transitions */
            --transition-fast: 150ms ease;
            --transition-normal: 250ms ease;
            --transition-smooth: 350ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           BASE STYLES
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html, body {
            height: 100%;
            overflow-x: hidden;
        }

        body {
            font-family: var(--font-sans);
            font-size: 16px;
            line-height: 1.5;
            color: var(--tg-theme-text-color);
            background: var(--tg-theme-bg-color);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           LAYOUT
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        #app {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .page {
            display: none;
            flex: 1;
            padding: var(--space-lg);
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-header {
            margin-bottom: var(--space-lg);
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            letter-spacing: -0.5px;
            margin-bottom: var(--space-xs);
        }

        .page-subtitle {
            color: var(--tg-theme-hint-color);
            font-size: 15px;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: CARDS
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .card {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
        }

        .card-elevated {
            background: var(--tg-theme-bg-color);
            box-shadow: var(--shadow-md);
        }

        .card-gradient {
            background: var(--gradient-primary);
            color: white;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-md);
        }

        .card-title {
            font-size: 17px;
            font-weight: 600;
        }

        .card-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 10px;
            border-radius: var(--radius-full);
            font-size: 13px;
            font-weight: 500;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: BUTTONS
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-sm);
            padding: 14px 24px;
            border: none;
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all var(--transition-fast);
            -webkit-tap-highlight-color: transparent;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover:not(:disabled) {
            box-shadow: var(--shadow-glow);
        }

        .btn-secondary {
            background: var(--tg-theme-secondary-bg-color);
            color: var(--tg-theme-text-color);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--tg-theme-button-color);
            color: var(--tg-theme-button-color);
        }

        .btn-success {
            background: var(--gradient-success);
            color: white;
        }

        .btn-block {
            width: 100%;
        }

        .btn-sm {
            padding: 10px 16px;
            font-size: 14px;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: INPUTS
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .input-group {
            margin-bottom: var(--space-lg);
        }

        .input-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--tg-theme-hint-color);
            margin-bottom: var(--space-sm);
        }

        .input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            background: var(--tg-theme-secondary-bg-color);
            font-family: inherit;
            font-size: 16px;
            color: var(--tg-theme-text-color);
            transition: all var(--transition-fast);
        }

        .input:focus {
            outline: none;
            border-color: var(--tg-theme-button-color);
            background: var(--tg-theme-bg-color);
        }

        .input::placeholder {
            color: var(--tg-theme-hint-color);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: LISTS
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
        }

        .list-item {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding: var(--space-md);
            background: var(--tg-theme-secondary-bg-color);
            border-radius: var(--radius-md);
            transition: background var(--transition-fast);
        }

        .list-item-clickable {
            cursor: pointer;
        }

        .list-item-clickable:active {
            background: var(--tg-theme-bg-color);
        }

        .list-item-avatar {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
            flex-shrink: 0;
        }

        .list-item-content {
            flex: 1;
            min-width: 0;
        }

        .list-item-title {
            font-weight: 600;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .list-item-subtitle {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
        }

        .list-item-action {
            flex-shrink: 0;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: CHIPS / TAGS
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .chip {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: var(--tg-theme-secondary-bg-color);
            border-radius: var(--radius-full);
            font-size: 13px;
            font-weight: 500;
        }

        .chip-success {
            background: var(--color-success-light);
            color: var(--color-success);
        }

        .chip-warning {
            background: var(--color-warning-light);
            color: var(--color-warning);
        }

        .chip-selectable {
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 2px solid transparent;
        }

        .chip-selectable.selected {
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border-color: var(--tg-theme-button-color);
        }

        .chips-group {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-sm);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: INVITE LINK BOX
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .invite-box {
            background: var(--tg-theme-secondary-bg-color);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .invite-link {
            flex: 1;
            font-family: monospace;
            font-size: 13px;
            color: var(--tg-theme-hint-color);
            word-break: break-all;
        }

        .invite-copy-btn {
            background: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            padding: 10px 16px;
            border-radius: var(--radius-sm);
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            flex-shrink: 0;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: EMPTY STATE
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .empty-state {
            text-align: center;
            padding: var(--space-2xl) var(--space-lg);
            color: var(--tg-theme-hint-color);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--space-md);
            opacity: 0.5;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--tg-theme-text-color);
            margin-bottom: var(--space-sm);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: LOADING
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .skeleton {
            background: linear-gradient(
                90deg,
                var(--tg-theme-secondary-bg-color) 25%,
                var(--tg-theme-bg-color) 50%,
                var(--tg-theme-secondary-bg-color) 75%
            );
            background-size: 200% 100%;
            animation: skeleton-shimmer 1.5s infinite;
            border-radius: var(--radius-md);
        }

        @keyframes skeleton-shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid var(--tg-theme-secondary-bg-color);
            border-top-color: var(--tg-theme-button-color);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            gap: var(--space-md);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: STATUS INDICATOR
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .status-pending {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: var(--space-2xl);
        }

        .status-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            margin-bottom: var(--space-lg);
        }

        .status-icon-waiting {
            background: var(--color-warning-light);
        }

        .status-icon-success {
            background: var(--color-success-light);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: TAB BAR
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .tabs {
            display: flex;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
            background: var(--tg-theme-secondary-bg-color);
            padding: 4px;
            border-radius: var(--radius-md);
        }

        .tab {
            flex: 1;
            padding: 10px;
            border: none;
            background: transparent;
            color: var(--tg-theme-hint-color);
            font-family: inherit;
            font-size: 14px;
            font-weight: 600;
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .tab.active {
            background: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            box-shadow: var(--shadow-sm);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: MODAL / SHEET
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .modal-backdrop {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: flex-end;
            z-index: 100;
            animation: fadeIn 0.2s ease;
        }

        .modal-backdrop.active {
            display: flex;
        }

        .modal-sheet {
            width: 100%;
            max-height: 90vh;
            background: var(--tg-theme-bg-color);
            border-radius: var(--radius-lg) var(--radius-lg) 0 0;
            padding: var(--space-lg);
            animation: slideUp 0.3s ease;
            overflow-y: auto;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }

        .modal-handle {
            width: 36px;
            height: 4px;
            background: var(--tg-theme-hint-color);
            opacity: 0.3;
            border-radius: 2px;
            margin: 0 auto var(--space-lg);
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: var(--space-lg);
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           PAGE-SPECIFIC: ONBOARDING
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .onboarding-hero {
            text-align: center;
            padding: var(--space-2xl) 0;
        }

        .onboarding-icon {
            width: 100px;
            height: 100px;
            background: var(--gradient-primary);
            border-radius: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-lg);
            font-size: 48px;
            box-shadow: var(--shadow-lg);
        }

        .onboarding-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: var(--space-sm);
        }

        .onboarding-subtitle {
            color: var(--tg-theme-hint-color);
            font-size: 16px;
            max-width: 280px;
            margin: 0 auto;
        }

        .onboarding-divider {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin: var(--space-lg) 0;
            color: var(--tg-theme-hint-color);
            font-size: 14px;
        }

        .onboarding-divider::before,
        .onboarding-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: var(--tg-theme-hint-color);
            opacity: 0.3;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           UTILITY CLASSES
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .text-center { text-align: center; }
        .text-muted { color: var(--tg-theme-hint-color); }
        .text-success { color: var(--color-success); }
        .text-error { color: var(--color-error); }
        .text-sm { font-size: 14px; }
        .font-semibold { font-weight: 600; }
        .mt-auto { margin-top: auto; }
        .mb-md { margin-bottom: var(--space-md); }
        .mb-lg { margin-bottom: var(--space-lg); }
        .hidden { display: none !important; }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: ORG HEADER
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .org-header {
            display: flex;
            align-items: flex-start;
            gap: var(--space-md);
            padding: var(--space-lg);
            background: var(--tg-theme-secondary-bg-color);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-lg);
        }

        .org-avatar {
            width: 60px;
            height: 60px;
            border-radius: var(--radius-md);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 24px;
            flex-shrink: 0;
        }

        .org-info {
            flex: 1;
            min-width: 0;
        }

        .org-name {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .org-description {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
            margin-bottom: var(--space-sm);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .org-stats {
            font-size: 13px;
            color: var(--tg-theme-hint-color);
        }

        .org-edit-btn {
            background: var(--tg-theme-bg-color);
            border: none;
            padding: 8px 14px;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 600;
            color: var(--tg-theme-button-color);
            cursor: pointer;
            flex-shrink: 0;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: MEMBER DETAIL MODAL
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .member-detail-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .member-detail-avatar {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-full);
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 22px;
        }

        .member-detail-info {
            flex: 1;
        }

        .member-detail-name {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .member-detail-meta {
            font-size: 14px;
            color: var(--tg-theme-hint-color);
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--tg-theme-hint-color);
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .bot-toggle-list {
            display: flex;
            flex-direction: column;
            gap: var(--space-sm);
            margin-bottom: var(--space-lg);
        }

        .bot-toggle-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-md);
            background: var(--tg-theme-secondary-bg-color);
            border-radius: var(--radius-md);
        }

        .bot-toggle-name {
            font-weight: 500;
        }

        /* Toggle switch */
        .toggle {
            position: relative;
            width: 48px;
            height: 28px;
            background: var(--tg-theme-hint-color);
            border-radius: 14px;
            cursor: pointer;
            transition: background var(--transition-fast);
        }

        .toggle.active {
            background: var(--color-success);
        }

        .toggle::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: transform var(--transition-fast);
            box-shadow: var(--shadow-sm);
        }

        .toggle.active::after {
            transform: translateX(20px);
        }

        .danger-zone {
            padding-top: var(--space-lg);
            border-top: 1px solid var(--tg-theme-secondary-bg-color);
        }

        .btn-danger {
            background: var(--color-error-light);
            color: var(--color-error);
        }

        .btn-danger:hover {
            background: var(--color-error);
            color: white;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           COMPONENTS: TEXTAREA
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        .textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid transparent;
            border-radius: var(--radius-md);
            background: var(--tg-theme-secondary-bg-color);
            font-family: inherit;
            font-size: 16px;
            color: var(--tg-theme-text-color);
            transition: all var(--transition-fast);
            resize: vertical;
            min-height: 80px;
        }

        .textarea:focus {
            outline: none;
            border-color: var(--tg-theme-button-color);
            background: var(--tg-theme-bg-color);
        }
    </style>
</head>
<body>
    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         APPLICATION MARKUP
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

    <div id="app">

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: LOADING
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-loading" class="page active">
            <div class="loading-center">
                <div class="loading-spinner"></div>
                <p class="text-muted">Loading...</p>
            </div>
        </div>

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: ONBOARDING (No org yet)
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-onboarding" class="page">
            <div class="onboarding-hero">
                <div class="onboarding-icon">ğŸš€</div>
                <h1 class="onboarding-title">Workforce Hub</h1>
                <p class="onboarding-subtitle">Manage your team and AI agents in one place</p>
            </div>

            <button class="btn btn-primary btn-block mb-md" onclick="showCreateOrgForm()">
                Create Organization
            </button>

            <div class="onboarding-divider">or</div>

            <p class="text-center text-muted text-sm mb-lg">
                Have an invite link? Ask your admin to share it with you on Telegram.
            </p>
        </div>

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: JOIN ORG (via invite link)
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-join" class="page">
            <div class="page-header">
                <h1 class="page-title">Join Organization</h1>
                <p class="page-subtitle" id="join-org-name">Loading...</p>
            </div>

            <div class="card card-elevated">
                <div class="input-group">
                    <label class="input-label">Your Full Name</label>
                    <input type="text" id="join-name-input" class="input" placeholder="Enter your name">
                </div>

                <p class="text-muted text-sm mb-lg">
                    Your name will be visible to the organization admin for approval.
                </p>

                <button class="btn btn-primary btn-block" id="join-submit-btn" onclick="submitJoinRequest()">
                    Request to Join
                </button>
            </div>
        </div>

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: PENDING (Waiting for approval)
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-pending" class="page">
            <div class="status-pending">
                <div class="status-icon status-icon-waiting">â³</div>
                <h2 class="page-title">Awaiting Approval</h2>
                <p class="text-muted" id="pending-message">
                    Your request to join has been sent. The admin will review it shortly.
                </p>
            </div>
        </div>

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: ADMIN DASHBOARD
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-admin" class="page">
            <!-- Organization Header -->
            <div class="org-header" id="org-header">
                <div class="org-avatar" id="org-avatar">A</div>
                <div class="org-info">
                    <div class="org-name" id="admin-org-name">Organization</div>
                    <div class="org-description hidden" id="org-description"></div>
                    <div class="org-stats" id="org-stats">Loading...</div>
                </div>
                <button class="org-edit-btn" onclick="openEditOrgModal()">Edit</button>
            </div>

            <!-- Invite Link Card -->
            <div class="card card-gradient mb-lg" id="invite-card">
                <div class="card-header">
                    <span class="card-title">Invite Team Members</span>
                    <span class="card-badge" id="invite-status-badge">Share</span>
                </div>
                <p class="text-sm mb-md" style="opacity: 0.9;" id="invite-status-text">
                    Share this link with your team via Telegram
                </p>
                <div class="invite-box" style="background: rgba(255,255,255,0.15);" id="invite-link-box">
                    <span class="invite-link" id="invite-link-text" style="color: white;">Loading...</span>
                    <button class="invite-copy-btn" id="invite-copy-btn" onclick="copyInviteLink()" style="background: white; color: #667eea;">
                        Copy
                    </button>
                </div>
                <button class="btn btn-block hidden" id="regenerate-btn" onclick="regenerateInviteLink()" style="margin-top: 12px; background: rgba(255,255,255,0.2); color: white; border: 2px solid rgba(255,255,255,0.4);">
                    Generate New Link
                </button>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="switchAdminTab('requests')">
                    Requests <span id="requests-count"></span>
                </button>
                <button class="tab" onclick="switchAdminTab('members')">
                    Members
                </button>
            </div>

            <!-- Pending Requests Tab -->
            <div id="tab-requests" class="tab-content">
                <div id="requests-list" class="list">
                    <!-- Populated by JS -->
                </div>
                <div id="requests-empty" class="empty-state hidden">
                    <div class="empty-state-icon">âœ¨</div>
                    <p class="empty-state-title">No pending requests</p>
                    <p>Share your invite link to add team members</p>
                </div>
            </div>

            <!-- Members Tab -->
            <div id="tab-members" class="tab-content hidden">
                <div id="members-list" class="list">
                    <!-- Populated by JS -->
                </div>
            </div>
        </div>

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: MEMBER DASHBOARD
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-member" class="page">
            <div class="page-header">
                <h1 class="page-title" id="member-org-name">Organization</h1>
                <p class="page-subtitle">Your Agents</p>
            </div>

            <div id="member-bots-list" class="list">
                <!-- Populated by JS -->
            </div>

            <div id="member-no-bots" class="empty-state hidden">
                <div class="empty-state-icon">ğŸ¤–</div>
                <p class="empty-state-title">No agents assigned yet</p>
                <p>Your admin will grant you access to agents soon</p>
            </div>
        </div>

        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             PAGE: CREATE ORG FORM
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div id="page-create-org" class="page">
            <div class="page-header">
                <h1 class="page-title">Create Organization</h1>
                <p class="page-subtitle">Set up your team workspace</p>
            </div>

            <div class="card card-elevated">
                <div class="input-group">
                    <label class="input-label">Your Full Name</label>
                    <input type="text" id="create-admin-name" class="input" placeholder="e.g., John Smith">
                </div>

                <div class="input-group">
                    <label class="input-label">Organization Name</label>
                    <input type="text" id="create-org-name" class="input" placeholder="e.g., Acme Corp">
                </div>

                <button class="btn btn-primary btn-block" onclick="createOrganization()">
                    Create Organization
                </button>
            </div>

            <button class="btn btn-secondary btn-block mt-auto" onclick="showPage('onboarding')">
                Back
            </button>
        </div>

    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MODAL: APPROVE REQUEST
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="modal-approve" class="modal-backdrop">
        <div class="modal-sheet">
            <div class="modal-handle"></div>

            <h2 class="modal-title">Approve Request</h2>

            <div class="list-item mb-lg">
                <div class="list-item-avatar" id="modal-user-avatar">?</div>
                <div class="list-item-content">
                    <div class="list-item-title" id="modal-user-name">User Name</div>
                    <div class="list-item-subtitle" id="modal-user-username">@username</div>
                </div>
            </div>

            <p class="input-label">Grant access to agents:</p>
            <div class="chips-group mb-lg" id="modal-bots-chips">
                <!-- Populated by JS -->
            </div>

            <div style="display: flex; gap: var(--space-sm);">
                <button class="btn btn-secondary" style="flex: 1;" onclick="rejectRequest()">
                    Reject
                </button>
                <button class="btn btn-success" style="flex: 2;" onclick="approveRequest()">
                    Approve
                </button>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MODAL: EDIT ORGANIZATION
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="modal-edit-org" class="modal-backdrop">
        <div class="modal-sheet">
            <div class="modal-handle"></div>

            <h2 class="modal-title">Edit Organization</h2>

            <div class="input-group">
                <label class="input-label">Organization Name</label>
                <input type="text" id="edit-org-name" class="input" placeholder="Organization name">
            </div>

            <div class="input-group">
                <label class="input-label">Description (optional)</label>
                <textarea id="edit-org-description" class="textarea" placeholder="Describe your organization..."></textarea>
            </div>

            <div style="display: flex; gap: var(--space-sm);">
                <button class="btn btn-secondary" style="flex: 1;" onclick="closeEditOrgModal()">
                    Cancel
                </button>
                <button class="btn btn-primary" style="flex: 2;" onclick="saveOrgChanges()">
                    Save Changes
                </button>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         MODAL: MEMBER MANAGEMENT
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <div id="modal-member" class="modal-backdrop">
        <div class="modal-sheet">
            <div class="modal-handle"></div>

            <div class="member-detail-header">
                <div class="member-detail-avatar" id="member-modal-avatar">?</div>
                <div class="member-detail-info">
                    <div class="member-detail-name" id="member-modal-name">Member Name</div>
                    <div class="member-detail-meta" id="member-modal-meta">@username â€¢ Member</div>
                </div>
            </div>

            <div class="mb-lg">
                <p class="text-sm text-muted" id="member-modal-activity">Last active: Never</p>
            </div>

            <div class="section-title">Agent Access</div>
            <div class="bot-toggle-list" id="member-modal-bots">
                <!-- Populated by JS -->
            </div>

            <button class="btn btn-primary btn-block mb-lg" onclick="saveMemberBots()">
                Save Changes
            </button>

            <div class="danger-zone" id="member-danger-zone">
                <div class="section-title">Danger Zone</div>
                <button class="btn btn-danger btn-block" onclick="confirmRemoveMember()">
                    Remove from Organization
                </button>
            </div>
        </div>
    </div>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         APPLICATION LOGIC
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <script>
        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           TELEGRAM INTEGRATION
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // Apply Telegram theme
        const applyTheme = () => {
            const root = document.documentElement;
            if (tg.themeParams) {
                Object.entries(tg.themeParams).forEach(([key, value]) => {
                    const cssVar = `--tg-theme-${key.replace(/_/g, '-')}`;
                    root.style.setProperty(cssVar, value);
                });
            }
        };
        applyTheme();
        tg.onEvent('themeChanged', applyTheme);

        // Parse start parameter (for invite links)
        const getStartParam = () => {
            const startParam = tg.initDataUnsafe?.start_param;
            if (startParam && startParam.startsWith('invite_')) {
                return { type: 'invite', code: startParam.replace('invite_', '') };
            }
            return null;
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           STATE
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const state = {
            user: null,
            memberships: [],
            pendingRequests: [],
            currentOrg: null,
            currentMembership: null,
            orgDetails: null,
            inviteLink: null,
            membershipRequests: [],
            members: [],
            availableBots: [],
            // For approval modal
            selectedRequest: null,
            selectedBotIds: [],
            // For member modal
            selectedMember: null,
            selectedMemberBotIds: []
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           API
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const API_BASE = '/api/hub';

        const api = {
            async fetch(endpoint, options = {}) {
                const res = await fetch(`${API_BASE}${endpoint}`, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Telegram-Init-Data': tg.initData,
                        ...options.headers
                    }
                });

                if (!res.ok) {
                    const error = await res.json().catch(() => ({ detail: 'Request failed' }));
                    throw new Error(error.detail || `Error ${res.status}`);
                }

                return res.json();
            },

            getMe: () => api.fetch('/me'),
            createOrg: (name, adminFullName) => api.fetch('/orgs', {
                method: 'POST',
                body: JSON.stringify({ name, admin_full_name: adminFullName })
            }),
            getOrgDetails: (orgId) => api.fetch(`/orgs/${orgId}/details`),
            updateOrg: (orgId, data) => api.fetch(`/orgs/${orgId}`, {
                method: 'PATCH',
                body: JSON.stringify(data)
            }),
            getInviteLink: (orgId) => api.fetch(`/orgs/${orgId}/invite-link`),
            regenerateInviteLink: (orgId) => api.fetch(`/orgs/${orgId}/regenerate-invite`, {
                method: 'POST'
            }),
            getInviteInfo: (code) => api.fetch(`/invite/${code}`),
            submitJoinRequest: (inviteCode, fullName) => api.fetch('/membership-requests', {
                method: 'POST',
                body: JSON.stringify({ invite_code: inviteCode, full_name: fullName })
            }),
            getMembershipRequests: (orgId) => api.fetch(`/orgs/${orgId}/membership-requests`),
            getMembers: (orgId) => api.fetch(`/orgs/${orgId}/members`),
            removeMember: (orgId, memberId) => api.fetch(`/orgs/${orgId}/members/${memberId}`, {
                method: 'DELETE'
            }),
            updateMemberBots: (orgId, memberId, botIds) => api.fetch(`/orgs/${orgId}/members/${memberId}/bots`, {
                method: 'PUT',
                body: JSON.stringify({ bot_ids: botIds })
            }),
            getBots: () => api.fetch('/bots'),
            approveRequest: (requestId, approved, botIds) => api.fetch(`/membership-requests/${requestId}/approve`, {
                method: 'POST',
                body: JSON.stringify({ request_id: requestId, approved, bot_ids: botIds })
            })
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           PAGE NAVIGATION
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const showPage = (pageName) => {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page-${pageName}`)?.classList.add('active');
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           INITIALIZATION
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const init = async () => {
            try {
                // Get user data FIRST to check existing membership status
                const data = await api.getMe();
                console.log('[Hub Init] API response:', JSON.stringify(data, null, 2));

                state.user = data.user;
                state.memberships = data.memberships || [];
                state.pendingRequests = data.pending_requests || [];

                console.log('[Hub Init] User:', state.user?.id, state.user?.full_name);
                console.log('[Hub Init] Memberships count:', state.memberships.length);
                console.log('[Hub Init] Pending requests count:', state.pendingRequests.length);

                // Check if user has pending requests
                if (state.pendingRequests.length > 0) {
                    const request = state.pendingRequests[0];
                    console.log('[Hub Init] Showing pending page for request:', request.id);
                    document.getElementById('pending-message').textContent =
                        `Your request to join "${request.organizations?.name || 'the organization'}" is being reviewed.`;
                    showPage('pending');
                    return;
                }

                // Check if user has memberships (prioritize existing membership over invite links)
                if (state.memberships.length > 0) {
                    const membership = state.memberships[0];
                    console.log('[Hub Init] Found membership:', membership.id, 'role:', membership.role);
                    state.currentOrg = membership.organizations;
                    state.currentMembership = membership;

                    if (membership.role === 'admin') {
                        console.log('[Hub Init] Loading admin dashboard');
                        await loadAdminDashboard();
                    } else {
                        console.log('[Hub Init] Loading member dashboard');
                        await loadMemberDashboard();
                    }
                    return;
                }

                // No membership or pending request - check for invite link
                const startParam = getStartParam();
                console.log('[Hub Init] No membership found. Start param:', startParam);

                if (startParam?.type === 'invite') {
                    console.log('[Hub Init] Handling invite link:', startParam.code);
                    await handleInviteLink(startParam.code);
                    return;
                }

                // No membership and no invite link - show onboarding
                console.log('[Hub Init] Showing onboarding page');
                showPage('onboarding');

            } catch (error) {
                console.error('[Hub Init] Error:', error);

                // On error, still try to handle invite link if present
                const startParam = getStartParam();
                if (startParam?.type === 'invite') {
                    console.log('[Hub Init] Error occurred, but handling invite link:', startParam.code);
                    await handleInviteLink(startParam.code);
                } else {
                    console.log('[Hub Init] Error occurred, showing onboarding');
                    showPage('onboarding');
                }
            }
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           INVITE LINK HANDLING
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        let currentInviteCode = null;

        const handleInviteLink = async (code) => {
            try {
                const info = await api.getInviteInfo(code);
                currentInviteCode = code;

                document.getElementById('join-org-name').textContent = `Join "${info.org_name}"`;
                document.getElementById('join-name-input').value = state.user?.full_name || '';

                showPage('join');
            } catch (error) {
                // Check if it's an expiration error (410 status)
                if (error.message.includes('expired')) {
                    alert('This invite link has expired. Please ask the organization admin for a new link.');
                } else {
                    alert('Invalid invite link. Please check the link and try again.');
                }
                showPage('onboarding');
            }
        };

        const submitJoinRequest = async () => {
            const nameInput = document.getElementById('join-name-input');
            const submitBtn = document.getElementById('join-submit-btn');
            const name = nameInput.value.trim();

            if (!name) {
                alert('Please enter your name');
                return;
            }

            submitBtn.disabled = true;
            submitBtn.textContent = 'Sending...';

            try {
                const result = await api.submitJoinRequest(currentInviteCode, name);
                document.getElementById('pending-message').textContent =
                    `Your request to join "${result.org_name}" has been sent. The admin will review it shortly.`;
                showPage('pending');
            } catch (error) {
                alert(error.message);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Request to Join';
            }
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           CREATE ORGANIZATION
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const showCreateOrgForm = () => {
            showPage('create-org');
        };

        const createOrganization = async () => {
            const adminNameInput = document.getElementById('create-admin-name');
            const orgNameInput = document.getElementById('create-org-name');
            const adminName = adminNameInput.value.trim();
            const orgName = orgNameInput.value.trim();

            if (!adminName) {
                alert('Please enter your full name');
                return;
            }

            if (!orgName) {
                alert('Please enter an organization name');
                return;
            }

            try {
                const org = await api.createOrg(orgName, adminName);
                state.currentOrg = org;
                state.currentMembership = { role: 'admin' };
                await loadAdminDashboard();
            } catch (error) {
                alert(error.message);
            }
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           ADMIN DASHBOARD
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const loadAdminDashboard = async () => {
            showPage('admin');

            // Load data in parallel
            const [orgDetails, inviteLink, requests, members, bots] = await Promise.all([
                api.getOrgDetails(state.currentOrg.id),
                api.getInviteLink(state.currentOrg.id),
                api.getMembershipRequests(state.currentOrg.id),
                api.getMembers(state.currentOrg.id),
                api.getBots().catch(() => [])
            ]);

            state.orgDetails = orgDetails;
            state.inviteLink = inviteLink;
            state.membershipRequests = requests;
            state.members = members;
            state.availableBots = bots;

            updateOrgHeader(orgDetails);
            updateInviteLinkDisplay(inviteLink);
            renderRequests();
            renderMembers();
        };

        const updateOrgHeader = (details) => {
            const initials = details.name.split(' ').map(w => w[0]).join('').substring(0, 2).toUpperCase();
            document.getElementById('org-avatar').textContent = initials;
            document.getElementById('admin-org-name').textContent = details.name;

            const descEl = document.getElementById('org-description');
            if (details.description) {
                descEl.textContent = details.description;
                descEl.classList.remove('hidden');
            } else {
                descEl.classList.add('hidden');
            }

            const createdDate = new Date(details.created_at).toLocaleDateString('en-US', {
                month: 'short',
                year: 'numeric'
            });
            document.getElementById('org-stats').textContent =
                `Created ${createdDate} â€¢ ${details.stats.member_count} member${details.stats.member_count !== 1 ? 's' : ''}`;
        };

        const updateInviteLinkDisplay = (inviteLink) => {
            const linkText = document.getElementById('invite-link-text');
            const statusBadge = document.getElementById('invite-status-badge');
            const statusText = document.getElementById('invite-status-text');
            const copyBtn = document.getElementById('invite-copy-btn');
            const regenerateBtn = document.getElementById('regenerate-btn');
            const card = document.getElementById('invite-card');

            linkText.textContent = inviteLink.url;

            if (inviteLink.is_expired) {
                // Link is expired
                statusBadge.textContent = 'Expired';
                statusBadge.style.background = 'rgba(239, 68, 68, 0.3)';
                statusText.textContent = 'This invite link has expired. Generate a new one to invite team members.';
                copyBtn.classList.add('hidden');
                regenerateBtn.classList.remove('hidden');
                card.style.background = 'linear-gradient(135deg, #6b7280 0%, #4b5563 100%)';
            } else {
                // Link is active - show time remaining
                const expiresAt = new Date(inviteLink.expires_at);
                const now = new Date();
                const hoursLeft = Math.max(0, Math.floor((expiresAt - now) / (1000 * 60 * 60)));
                const minsLeft = Math.max(0, Math.floor(((expiresAt - now) % (1000 * 60 * 60)) / (1000 * 60)));

                statusBadge.textContent = `${hoursLeft}h ${minsLeft}m left`;
                statusBadge.style.background = 'rgba(255, 255, 255, 0.2)';
                statusText.textContent = 'Share this link with your team via Telegram';
                copyBtn.classList.remove('hidden');
                regenerateBtn.classList.add('hidden');
                card.style.background = 'var(--gradient-primary)';
            }
        };

        const regenerateInviteLink = async () => {
            const btn = document.getElementById('regenerate-btn');
            btn.disabled = true;
            btn.textContent = 'Generating...';

            try {
                const newLink = await api.regenerateInviteLink(state.currentOrg.id);
                state.inviteLink = newLink;
                updateInviteLinkDisplay(newLink);
            } catch (error) {
                alert(error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Generate New Link';
            }
        };

        const switchAdminTab = (tab) => {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.tab[onclick="switchAdminTab('${tab}')"]`).classList.add('active');

            document.getElementById('tab-requests').classList.toggle('hidden', tab !== 'requests');
            document.getElementById('tab-members').classList.toggle('hidden', tab !== 'members');
        };

        const copyInviteLink = async () => {
            try {
                await navigator.clipboard.writeText(state.inviteLink.url);

                // Visual feedback
                const btn = document.getElementById('invite-copy-btn');
                btn.textContent = 'Copied!';
                setTimeout(() => btn.textContent = 'Copy', 2000);
            } catch {
                // Fallback for older browsers
                alert('Link: ' + state.inviteLink.url);
            }
        };

        const renderRequests = () => {
            const list = document.getElementById('requests-list');
            const empty = document.getElementById('requests-empty');
            const countBadge = document.getElementById('requests-count');

            if (state.membershipRequests.length === 0) {
                list.classList.add('hidden');
                empty.classList.remove('hidden');
                countBadge.textContent = '';
                return;
            }

            list.classList.remove('hidden');
            empty.classList.add('hidden');
            countBadge.textContent = `(${state.membershipRequests.length})`;

            list.innerHTML = state.membershipRequests.map(req => `
                <div class="list-item list-item-clickable" onclick="openApproveModal('${req.id}')">
                    <div class="list-item-avatar">${req.full_name.charAt(0).toUpperCase()}</div>
                    <div class="list-item-content">
                        <div class="list-item-title">${escapeHtml(req.full_name)}</div>
                        <div class="list-item-subtitle">${req.telegram_username ? '@' + req.telegram_username : 'Pending'}</div>
                    </div>
                    <div class="list-item-action">
                        <span class="chip chip-warning">Review</span>
                    </div>
                </div>
            `).join('');
        };

        const renderMembers = () => {
            const list = document.getElementById('members-list');

            list.innerHTML = state.members.map(member => {
                const lastActive = member.last_active_at
                    ? formatTimeAgo(new Date(member.last_active_at))
                    : 'Never';

                return `
                <div class="list-item ${member.role !== 'admin' ? 'list-item-clickable' : ''}"
                     ${member.role !== 'admin' ? `onclick="openMemberModal('${member.id}')"` : ''}>
                    <div class="list-item-avatar">${member.full_name.charAt(0).toUpperCase()}</div>
                    <div class="list-item-content">
                        <div class="list-item-title">${escapeHtml(member.full_name)}</div>
                        <div class="list-item-subtitle">
                            ${member.role === 'admin' ? 'ğŸ‘‘ Admin' : `${member.bot_access.length} agents â€¢ Active ${lastActive}`}
                        </div>
                    </div>
                    ${member.role === 'admin' ? '<span class="chip">Admin</span>' : '<span class="chip">Manage</span>'}
                </div>
            `;
            }).join('');
        };

        const formatTimeAgo = (date) => {
            const now = new Date();
            const diffMs = now - date;
            const diffMins = Math.floor(diffMs / 60000);
            const diffHours = Math.floor(diffMs / 3600000);
            const diffDays = Math.floor(diffMs / 86400000);

            if (diffMins < 1) return 'just now';
            if (diffMins < 60) return `${diffMins}m ago`;
            if (diffHours < 24) return `${diffHours}h ago`;
            if (diffDays < 7) return `${diffDays}d ago`;
            return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           APPROVAL MODAL
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const openApproveModal = (requestId) => {
            const request = state.membershipRequests.find(r => r.id === requestId);
            if (!request) return;

            state.selectedRequest = request;
            state.selectedBotIds = [];

            document.getElementById('modal-user-name').textContent = request.full_name;
            document.getElementById('modal-user-username').textContent =
                request.telegram_username ? '@' + request.telegram_username : 'No username';
            document.getElementById('modal-user-avatar').textContent =
                request.full_name.charAt(0).toUpperCase();

            // Render bot chips
            const chipsContainer = document.getElementById('modal-bots-chips');
            if (state.availableBots.length > 0) {
                chipsContainer.innerHTML = state.availableBots.map(bot => `
                    <button class="chip chip-selectable" data-bot-id="${bot.id}" onclick="toggleBotSelection('${bot.id}')">
                        ${escapeHtml(bot.name)}
                    </button>
                `).join('');
            } else {
                chipsContainer.innerHTML = '<p class="text-muted text-sm">No agents available yet</p>';
            }

            document.getElementById('modal-approve').classList.add('active');
        };

        const closeApproveModal = () => {
            document.getElementById('modal-approve').classList.remove('active');
            state.selectedRequest = null;
            state.selectedBotIds = [];
        };

        const toggleBotSelection = (botId) => {
            const index = state.selectedBotIds.indexOf(botId);
            if (index > -1) {
                state.selectedBotIds.splice(index, 1);
            } else {
                state.selectedBotIds.push(botId);
            }

            // Update chip visual
            const chip = document.querySelector(`[data-bot-id="${botId}"]`);
            chip?.classList.toggle('selected', state.selectedBotIds.includes(botId));
        };

        const approveRequest = async () => {
            if (!state.selectedRequest) return;

            try {
                await api.approveRequest(state.selectedRequest.id, true, state.selectedBotIds);

                // Remove from list and refresh
                state.membershipRequests = state.membershipRequests.filter(
                    r => r.id !== state.selectedRequest.id
                );
                closeApproveModal();
                renderRequests();

                // Refresh members
                const members = await api.getMembers(state.currentOrg.id);
                state.members = members;
                renderMembers();

            } catch (error) {
                alert(error.message);
            }
        };

        const rejectRequest = async () => {
            if (!state.selectedRequest) return;

            if (!confirm('Are you sure you want to reject this request?')) return;

            try {
                await api.approveRequest(state.selectedRequest.id, false, []);

                state.membershipRequests = state.membershipRequests.filter(
                    r => r.id !== state.selectedRequest.id
                );
                closeApproveModal();
                renderRequests();

            } catch (error) {
                alert(error.message);
            }
        };

        // Close modal on backdrop click
        document.getElementById('modal-approve').addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-backdrop')) {
                closeApproveModal();
            }
        });

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           EDIT ORGANIZATION MODAL
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const openEditOrgModal = () => {
            document.getElementById('edit-org-name').value = state.orgDetails?.name || state.currentOrg.name;
            document.getElementById('edit-org-description').value = state.orgDetails?.description || '';
            document.getElementById('modal-edit-org').classList.add('active');
        };

        const closeEditOrgModal = () => {
            document.getElementById('modal-edit-org').classList.remove('active');
        };

        const saveOrgChanges = async () => {
            const name = document.getElementById('edit-org-name').value.trim();
            const description = document.getElementById('edit-org-description').value.trim();

            if (!name) {
                alert('Organization name is required');
                return;
            }

            try {
                const result = await api.updateOrg(state.currentOrg.id, {
                    name,
                    description: description || null
                });

                // Update local state
                state.currentOrg.name = name;
                if (state.orgDetails) {
                    state.orgDetails.name = name;
                    state.orgDetails.description = description || null;
                    updateOrgHeader(state.orgDetails);
                }

                closeEditOrgModal();
            } catch (error) {
                alert(error.message);
            }
        };

        document.getElementById('modal-edit-org').addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-backdrop')) {
                closeEditOrgModal();
            }
        });

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           MEMBER MANAGEMENT MODAL
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const openMemberModal = (memberId) => {
            const member = state.members.find(m => m.id === memberId);
            if (!member || member.role === 'admin') return;

            state.selectedMember = member;
            state.selectedMemberBotIds = member.bot_access.map(b => b.bot_id);

            document.getElementById('member-modal-avatar').textContent = member.full_name.charAt(0).toUpperCase();
            document.getElementById('member-modal-name').textContent = member.full_name;
            document.getElementById('member-modal-meta').textContent =
                `${member.telegram_username ? '@' + member.telegram_username : 'No username'} â€¢ Member`;

            const lastActive = member.last_active_at
                ? `Last active: ${formatTimeAgo(new Date(member.last_active_at))}`
                : 'Last active: Never';
            document.getElementById('member-modal-activity').textContent = lastActive;

            // Render bot toggles
            const botsContainer = document.getElementById('member-modal-bots');
            if (state.availableBots.length > 0) {
                botsContainer.innerHTML = state.availableBots.map(bot => {
                    const hasAccess = state.selectedMemberBotIds.includes(bot.id);
                    return `
                        <div class="bot-toggle-item">
                            <span class="bot-toggle-name">${escapeHtml(bot.name)}</span>
                            <div class="toggle ${hasAccess ? 'active' : ''}"
                                 data-bot-id="${bot.id}"
                                 onclick="toggleMemberBot('${bot.id}')"></div>
                        </div>
                    `;
                }).join('');
            } else {
                botsContainer.innerHTML = '<p class="text-muted text-sm">No agents available</p>';
            }

            document.getElementById('modal-member').classList.add('active');
        };

        const closeMemberModal = () => {
            document.getElementById('modal-member').classList.remove('active');
            state.selectedMember = null;
            state.selectedMemberBotIds = [];
        };

        const toggleMemberBot = (botId) => {
            const index = state.selectedMemberBotIds.indexOf(botId);
            if (index > -1) {
                state.selectedMemberBotIds.splice(index, 1);
            } else {
                state.selectedMemberBotIds.push(botId);
            }

            // Update toggle visual
            const toggle = document.querySelector(`#member-modal-bots [data-bot-id="${botId}"]`);
            toggle?.classList.toggle('active', state.selectedMemberBotIds.includes(botId));
        };

        const saveMemberBots = async () => {
            if (!state.selectedMember) return;

            try {
                await api.updateMemberBots(
                    state.currentOrg.id,
                    state.selectedMember.id,
                    state.selectedMemberBotIds
                );

                // Refresh members list
                const members = await api.getMembers(state.currentOrg.id);
                state.members = members;
                renderMembers();

                closeMemberModal();
            } catch (error) {
                alert(error.message);
            }
        };

        const confirmRemoveMember = async () => {
            if (!state.selectedMember) return;

            const confirmed = confirm(
                `Remove ${state.selectedMember.full_name} from ${state.currentOrg.name}?\n\nThis will revoke all their agent access.`
            );

            if (!confirmed) return;

            try {
                await api.removeMember(state.currentOrg.id, state.selectedMember.id);

                // Refresh members list and org details
                const [members, orgDetails] = await Promise.all([
                    api.getMembers(state.currentOrg.id),
                    api.getOrgDetails(state.currentOrg.id)
                ]);
                state.members = members;
                state.orgDetails = orgDetails;
                renderMembers();
                updateOrgHeader(orgDetails);

                closeMemberModal();
            } catch (error) {
                alert(error.message);
            }
        };

        document.getElementById('modal-member').addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-backdrop')) {
                closeMemberModal();
            }
        });

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           MEMBER DASHBOARD
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const loadMemberDashboard = async () => {
            document.getElementById('member-org-name').textContent = state.currentOrg.name;
            showPage('member');

            // Get member's bot access
            const members = await api.getMembers(state.currentOrg.id);
            const me = members.find(m => m.user_id === state.user.id);

            if (me && me.bot_access.length > 0) {
                document.getElementById('member-no-bots').classList.add('hidden');
                document.getElementById('member-bots-list').innerHTML = me.bot_access.map(bot => `
                    <div class="list-item list-item-clickable" onclick="openAgent('${bot.bot_id}')">
                        <div class="list-item-avatar" style="background: var(--gradient-success);">ğŸ¤–</div>
                        <div class="list-item-content">
                            <div class="list-item-title">${escapeHtml(bot.bot_name)}</div>
                            <div class="list-item-subtitle">Access granted</div>
                        </div>
                        <span class="chip chip-success">Active</span>
                    </div>
                `).join('');
            } else {
                document.getElementById('member-bots-list').classList.add('hidden');
                document.getElementById('member-no-bots').classList.remove('hidden');
            }
        };

        const openAgent = (agentName) => {
            // Navigate to the agent's mini-app
            window.location.href = `/app/${agentName}`;
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           UTILITIES
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        const escapeHtml = (text) => {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        };

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           START APP
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */

        init();
    </script>
</body>
</html>
